function pppSetLengthColors(e,t){tweetLengthYellow>e?t.css("background-color","#339933"):e>=tweetLengthYellow&&tweetLengthRed>=e?t.css("background-color","#CC9933"):e>tweetLengthRed&&t.css("background-color","#FF3333")}var tweetLengthYellow=100,tweetLengthRed=117;!function(e){e(".share-time-selector").timepicker({step:15}),e(".share-date-selector").datepicker({dateFormat:"mm/dd/yy",minDate:0}),e("#bitly-login").click(function(t){t.preventDefault();var a={},n=e("#bitly-login");n.removeClass("button-primary"),n.addClass("button-secondary"),n.css("opacity",".5"),e(".spinner").show(),e("#ppp-bitly-invalid-login").hide(),a.action="ppp_bitly_connect",a.username=e("#bitly-username").val(),a.password=e("#bitly-password").val(),e.post(ajaxurl,a,function(t){if("1"==t){var a=e("#bitly-redirect-url").val();window.location.replace(a)}else"INVALID_LOGIN"===t&&(e(".spinner").hide(),e("#ppp-bitly-invalid-login").show(),n.addClass("button-primary"),n.removeClass("button-secondary"),n.css("opacity","1"))})}),e("#fb-page").change(function(){var t={},a=e("#fb-page");a.attr("disabled","disabled"),a.css("opacity",".5"),a.next(".spinner").show(),t.action="fb_set_page",t.account=a.val(),a.width("75%"),e.post(ajaxurl,t,function(e){a.removeAttr("disabled"),a.css("opacity","1"),a.next(".spinner").hide(),a.width("100%")})}),e("#ppp-tabs li").click(function(t){t.preventDefault(),e("#ppp-tabs li").removeClass("tabs"),e(this).addClass("tabs");var a=e(this).children(":first").attr("href");return e("#ppp_schedule_metabox .wp-tab-panel").hide(),e(a).show(),!1}),e("#ppp-social-connect-tabs a").click(function(t){t.preventDefault(),e("#ppp-social-connect-tabs a").removeClass("nav-tab-active"),e(this).addClass("nav-tab-active");var a=e(this).attr("href");return e(".ppp-social-connect").hide(),e(a).show(),!1});var t={init:function(){this.share_on_publish(),this.featured_image()},share_on_publish:function(){e(".ppp-toggle-share-on-publish").change(function(){var t=e(this).val(),a=e(this).parent().next(".ppp-fields");-1==t?a.hide():0==t?(a.show(),a.find(".ppp-share-on-publish").hide(),a.find(".ppp-schedule-share").show()):(a.show(),a.find(".ppp-share-on-publish").show(),a.find(".ppp-schedule-share").hide())})},featured_image:function(){var t;window.formfield="",e("body").on("click",".ppp-upload-file-button",function(a){a.preventDefault();var n=e(this);return window.formfield=e(this).closest(".ppp-repeatable-upload-wrapper"),t?void t.open():(t=wp.media.frames.file_frame=wp.media({frame:"post",state:"insert",title:n.data("uploader-title"),button:{text:n.data("uploader-button-text")},multiple:"0"==e(this).data("multiple")?!1:!0}),t.on("menu:render:default",function(e){var t={};e.unset("library-separator"),e.unset("gallery"),e.unset("featured-image"),e.unset("embed"),e.set(t)}),t.on("insert",function(){var e=t.state().get("selection");e.each(function(e,t){e=e.toJSON(),window.formfield.find(".ppp-repeatable-attachment-id-field").val(e.id),window.formfield.find(".ppp-repeatable-upload-field").val(e.url).change()})}),void t.open())});var t;window.formfield="",e("body").on("change",".ppp-upload-field",function(t){if(""==e(this).val()){var a=e(this).prev(".ppp-repeatable-attachment-id-field");a.val("")}})}};t.init();var a={init:function(){this.add(),this.duplicate(),this.remove(),this.view_all(),this.share_on_publish(),this.count_length(),this.check_timestamps(),this.show_hide_conflict_warning(),e(".ppp-tweet-wrapper .ppp-text-length").each(function(){pppSetLengthColors(e(this).prev(".ppp-tweet-text-repeatable").val().length,e(this))})},clone_repeatable:function(t,a){"undefined"==typeof a&&(a=!0);var n=highest=1;return t.parent().find(".ppp-repeatable-row").each(function(){var t=e(this).data("key");parseInt(t)>highest&&(highest=t)}),n=highest+=1,clone=t.clone(),clone.find("select").each(function(){e(this).val(t.find('select[name="'+e(this).attr("name")+'"]').val())}),clone.removeClass("ppp-add-blank"),clone.removeClass("ppp-row-warning"),clone.attr("data-key",n),a&&clone.find("td input, td select, textarea").val(""),clone.find("input, select, textarea").each(function(){var t=e(this).attr("name");t=t.replace(/\[(\d+)\]/,"["+parseInt(n)+"]"),e(this).attr("name",t).attr("id",t),e(this).removeClass("hasDatepicker"),e(this).prop("readonly",!1)}),clone.find(".ppp-upload-file").show(),clone},add:function(){e("body").on("click",".submit .ppp-add-repeatable",function(t){t.preventDefault();var n=e(this),p=n.parent().parent().prevAll("tr").not(".past-share").first(),i=a.clone_repeatable(p);i.find(".ppp-text-length").text("0").css("background-color","#339933"),i.insertAfter(p),e(".share-time-selector").timepicker({step:15}),e(".share-date-selector").datepicker({dateFormat:"mm/dd/yy",minDate:0})})},duplicate:function(){e("body").on("click",".ppp-clone-tweet",function(t){t.preventDefault();var n=e(this),p=n.parent().parent(),i=a.clone_repeatable(p,!1);i.find(".share-time-selector").val(""),i.find(".share-date-selector").val(""),i.find(".ppp-action-icons a").show(),i.removeClass("past-share"),i.insertBefore(".ppp-repeatable-twitter:last"),e(".share-time-selector").timepicker({step:15}),e(".share-date-selector").datepicker({dateFormat:"mm/dd/yy",minDate:0})})},remove:function(){e("body").on("click",".ppp-remove-repeatable",function(t){t.preventDefault();var n=e(this).parent().parent("tr"),p=e(this).data("type"),i="tr.ppp-repeatable-"+p,r=e(i).length;r>1?(e("input, select",n).val(""),n.fadeOut("fast").remove()):(n.find("input").val("").trigger("change"),"linkedin"==p&&e(".ppp-repeatable-textarea").val("")),a.show_hide_conflict_warning(),e(i).each(function(t){e(this).find("input, select").each(function(){var a=e(this).attr("name");a=a.replace(/\[(\d+)\]/,"["+t+"]"),e(this).attr("name",a).attr("id",a)})})})},view_all:function(){e(".ppp-view-all").click(function(t){t.preventDefault(),e(".ppp-tweet-fields table .past-share").slideToggle()})},share_on_publish:function(){e("#tw #ppp_share_on_publish").click(function(){e(this).parent().siblings(".ppp_share_on_publish_text").toggle()})},count_length:function(){e("body").on("keyup change focusout","#tw .ppp-tweet-text-repeatable, #tw .ppp-share-text, #tw .ppp-upload-field, #tw .ppp-tw-featured-image-input",function(t){if(!(t.shiftKey||t.ctrlKey||t.altKey)){var a=e(this);if("_ppp_share_on_publish_text"==a.attr("name"))var n=a.next(".ppp-text-length"),p=a.val().length;else if(a.hasClass("ppp-tw-featured-image-input"))var i=a.parent().prev(),n=i.find(".ppp-text-length"),p=i.find(".ppp-tweet-text-repeatable").val().length;else if(a.hasClass("ppp-upload-field"))var i=a.parent().parent().prev(),n=i.find(".ppp-text-length"),p=i.find(".ppp-tweet-text-repeatable").val().length;else var n=a.next(".ppp-text-length"),p=a.val().length;pppSetLengthColors(p,n),n.text(p)}})},check_timestamps:function(){e("body").on("change",".share-date-selector, .share-time-selector",function(t){var n=e(this).parent().parent(),p=e(n).find(".share-date-selector").val(),i=e(n).find(".share-time-selector").val();if(""==p||""==i)return!1;var r={action:"ppp_has_schedule_conflict",date:p,time:i};e.post(ajaxurl,r,function(t){1==t?e(n).addClass("ppp-row-warning"):e(n).removeClass("ppp-row-warning"),a.show_hide_conflict_warning()})})},show_hide_conflict_warning:function(){e(".ppp-repeatable-table > tbody > tr.ppp-row-warning").length>0?e("#ppp-show-conflict-warning").slideDown():e("#ppp-show-conflict-warning").slideUp()}};a.init(),e("body").on("focusin",".ppp-tweet-text-repeatable",function(){e(".ppp-repeatable-upload-wrapper").animate({width:"100px"},200,function(){})}),e("body").on("focusout",".ppp-tweet-text-repeatable",function(){e(".ppp-repeatable-upload-wrapper").animate({width:"200px"},200,function(){})}),e(".notice.is-dismissible").on("click",".notice-dismiss",function(t){t.preventDefault();var a=e(this),n=a.parent().data("service");if(n){var p={action:"ppp_dismiss_notice-"+n,url:ajaxurl,nag:"ppp-dismiss-refresh-"+n};e.post(ajaxurl,p,function(e){})}})}(jQuery);